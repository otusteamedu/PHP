version: '3'

services:
  php_fpm_service:
    build:
      context: ./php-fpm
      dockerfile: Dockerfile
      args:
        UID: $UID
        NGINX_PHP_USER: $NGINX_PHP_USER
    image: hw-5-code-architecture/php
    volumes:
      - ./../logs/hw-5-code-architecture/sock:/sock
      - ./code:/data/site.default
    networks:
      - app-network

  nginx_service:
    build:
      context: ./nginx
      dockerfile: Dockerfile
      args:
        UID: $UID
        NGINX_PHP_USER: $NGINX_PHP_USER
    image: hw-5-code-architecture/nginx
    ports:
      - $APP_PORT1:80
      - $APP_PORT2:443
    volumes:
      - ./../logs/hw-5-code-architecture/sock:/sock
      - ./nginx/default.conf:/etc/nginx/sites-enabled/default
      - ./../logs/hw-5-code-architecture/nginx-log:/var/log/nginx
    networks:
      - app-network

networks:
  app-network:
    driver: bridge