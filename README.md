# Домашнее задание №16
API

## Цель
Научиться создавать универсальный интерфейс для различных потребителей (frontend фреймворки, мобильные приложения, сторонние приложения).

## Задача
Используя мини-приложение, разработанное в прошлом модуле, необходимо реализовать `Rest API` с использованием очередей. Ваши клиенты будут отправлять запросы на обработку, а вы будете складывать их в очередь и возвращать номер запроса. В фоновом режиме вы будете обрабатывать запросы, а ваши клиенты периодически, используя номер запроса, будут проверять статус его обработки. 

## Критерии оценки
1. `stateless` схема работы,
1. работа с очередью с возможностью замены решения очереди,
1. желательно привести пример работы `API` на нескольких серверах с балансировкой.

## Краткое описание приложения
Приложение получает целое число и средствами базы данных генерирует случайные строки в таблице БД. Для эмуляции тяжелого запроса отправляется большое количество строк.

## API
Эндпоинт|Метод|Описание
---|---|---
http://localhost/|GET|Используется для пинга
http://localhost/init|GET|Инициализация БД
http://localhost/list|GET|Выводит список из 10 записей (используется в служебных целях для проверки обновления данных)
http://localhost/add/<количество_строк>|POST|Синхронный метод добавления случайных строк в БД
http://localhost/acyncadd/<количество_строк>|POST|Асинхронный метод добавления случайных строк в БД
http://localhost/status/<номер_запроса>|GET|Проверка статуса асинхронного запроса по его идентификатору

## Как проверить выполненное задание
1. запустить все службы `docker-compose up -d`,
1. внутри контейнера `php-fpm` запустить `composer install --no-dev`,
1. внутри контейнера `php-fpm` запустить consumer `php ./console/consumer.php`,
1. провести инициализацию базы данных http://localhost/init,
1. проверить синхронный запрос (для наглядности рекомендуется задать большое количество строк, например 300000),
1. проверить асинхронный запрос (количество строк следует задать такое же, что и в предыдущем пункте),
1. запустить браузерный клиент http://localhost/client.html и проверить работу статусов асинхронного запроса.

Для проверки задания приложена [Postman коллекция](postman_collection.json). 