services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: true
    App\:
        resource: '../app/'
        exclude:
            - '../app/Kernel.php'
            - '../app/Exceptions/*'

    App\Controllers\:
        resource: '../app/Controllers/'
        tags: ['controller.service_arguments']

    App\Services\:
        resource: '../app/Services/'
        tags: ['services']

    App\Services\YoutubeChannelService\:
        resource: '../app/Services/ChannelVideoService.php'
        public: true
        autowire: true
        arguments:
            ReadRepositoryInterface $youtubeChannelRepository: '@youtube.channel.repo'
            HydratorInterface $channelModelHydrator: '@youtube.channel.hydrator'
            ReadRepositoryInterface $youtubeSearchRepository: '@youtube.search.repo'
            HydratorInterface $searchModelHydrator: '@youtube.search.hydrator'
            ReadRepositoryInterface $youtubeVideoRepository: '@youtube.video.repo'
            HydratorInterface $videoModelHydrator: '@youtube.video.hydrator'
            CUDRepositoryInterface $elasticChannelRepository: '@elastic.channel.repo'
            CUDRepositoryInterface $elasticVideoRepository: '@elastic.video.repo'
        tags: ['services']

    App\Repositories\:
        resource: '../app/Repositories/'
        tags: ['repositories']

    App\Repositories\ReadRepositoryInterface $youtubeChannelRepository: '@youtube.channel.repo'
    youtube.channel.repo:
        class: 'App\Repositories\YoutubeChannelRepository'
        public: true
        autowire: true
        tags: ['repositories']

    App\ModelHydrators\YoutubeHydratorInterface $channelModelHydrator: '@youtube.channel.hydrator'
    youtube.channel.hydrator:
        class: 'App\ModelHydrators\YoutubeChannelModelHydrator'
        public: true
        autowire: true
        tags: ['hydrators']

    App\Repositories\ReadRepositoryInterface $youtubeSearchRepository: '@youtube.search.repo'
    youtube.search.repo:
        class: 'App\Repositories\YoutubeSearchRepository'
        public: true
        autowire: true
        tags: ['repositories']

    App\ModelHydrators\YoutubeHydratorInterface $searchModelHydrator: '@youtube.search.hydrator'
    youtube.search.hydrator:
        class: 'App\ModelHydrators\YoutubeSearchModelHydrator'
        public: true
        autowire: true
        tags: ['hydrators']

    App\Repositories\ReadRepositoryInterface $youtubeVideoRepository: '@youtube.video.repo'
    youtube.video.repo:
        class: 'App\Repositories\YoutubeVideoRepository'
        public: true
        autowire: true
        tags: ['repositories']

    App\ModelHydrators\YoutubeHydratorInterface $videoModelHydrator: '@youtube.video.hydrator'
    youtube.video.hydrator:
        class: 'App\ModelHydrators\YoutubeVideoModelHydrator'
        public: true
        autowire: true
        tags: ['hydrators']

    App\Repositories\CUDRepositoryInterface $elasticChannelRepository: '@elastic.channel.repo'
    elastic.channel.repo:
        class: 'App\Repositories\ElasticChannelRepository'
        public: true
        autowire: true
        tags: ['repositories']

    App\Repositories\CUDRepositoryInterface $elasticVideoRepository: '@elastic.video.repo'
    elastic.video.repo:
        class: 'App\Repositories\ElasticVideoRepository'
        public: true
        autowire: true
        tags: ['repositories']

    App\Services\StatisticsService\:
        resource: '../app/Services/StatisticsService.php'
        public: true
        autowire: true
        arguments:
            CUDRepositoryInterface $elasticChannelRepository: '@elastic.channel.repo'
            ElasticHydratorInterface $channelModelHydrator: '@elastic.channel.hydrator'
        tags: ['services']

    App\ModelHydrators\ElasticHydratorInterface $channelModelHydrator: '@elastic.video.hydrator'
    elastic.video.hydrator:
        class: 'App\ModelHydrators\ElasticChannelModelHydrator'
        public: true
        autowire: true
        tags: ['hydrators']

    App\Services\RedisEventService\:
        resource: '../app/Services/RedisEventService.php'
        public: true
        autowire: true
        arguments:
            CUDRepositoryInterface $eventRepository: '@redis.event.repo'
            RequestHydratorInterface $requestModelHydrator: '@request.event.hydrator'
            RedisHydratorInterface $redisModelHydrator: '@redis.event.hydrator'
        tags: ['services']

    App\Repositories\CUDRepositoryInterface $eventRepository: '@redis.event.repo'
    redis.event.repo:
        class: 'App\Repositories\RedisEventRepository'
        public: true
        autowire: true
        tags: ['repositories']

    App\ModelHydrators\RequestHydratorInterface $requestModelHydrator: '@request.event.hydrator'
    request.event.hydrator:
        class: 'App\ModelHydrators\RequestEventModelHydrator'
        public: true
        autowire: true
        tags: ['hydrators']

    App\ModelHydrators\RedisHydratorInterface $redisModelHydrator: '@redis.event.hydrator'
    redis.event.hydrator:
        class: 'App\ModelHydrators\RedisEventModelHydrator'
        public: true
        autowire: true
        tags: ['hydrators']

    PDO:
        class: '\PDO'
        public: true
        autowire: true
        arguments:
            $dsn: "pgsql:host='%env(string:POSTGRESQL_HOST)%';port=5432;dbname='%env(string:POSTGRESQL_DATABASE)%';user='%env(string:POSTGRESQL_USERNAME)%';password='%env(string:POSTGRESQL_PASSWORD)%'"
        tags: ['pdo']
